<!DOCTYPE html>
<html lang="en">

<head>
  <!-- HTML5 META Tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Crucible Dashboard">
  <meta name="author" content="NP">

  <title>Crucible Dashboard</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Mina" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">

  <!-- Vendor Imports (CSS) -->
  <link href="../node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="../node_modules/@fortawesome/fontawesome-free-webfonts/css/fa-solid.css" rel="stylesheet">
  <link href="../node_modules/@fortawesome/fontawesome-free-webfonts/css/fontawesome.css" rel="stylesheet">
  <link href="../node_modules/jsgrid/dist/jsgrid.min.css" rel="stylesheet">
  <link href="../node_modules/jsgrid/dist/jsgrid-theme.min.css" rel="stylesheet">

  <!-- App CSS -->
  <link href="../src/css/app.css" rel="stylesheet">
  <link href="../src/css/navbar.css" rel="stylesheet">
  <link href="../src/css/sidebar.css" rel="stylesheet">
  <link href="../src/css/modal.css" rel="stylesheet">
  <link href="../src/css/grid.css" rel="stylesheet">

  <!-- 
    jQuery (Required by Bootstrap & JSGrid)
    Should be declared before other JS imports.
   -->
  <script>
    var $ = jQuery = require("jquery")
  </script>

  <!-- Vendor Imports (JS) -->
  <script src="../node_modules/jquery/dist/jquery.slim.min.js"></script>
  <script src="../node_modules/popper.js/dist/umd/popper.min.js"></script>
  <script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="../node_modules/jsgrid/dist/jsgrid.min.js"></script>

  <script src="../src/js/vendor/particles.js"></script>

  <!-- Global Variables -->
  <script type="text/javascript">
    // Constants
    const appConstants = require("../src/js/constants/app-constants");

    // Pending Review Grid
    const pendingReviewGrid = require("../src/js/renderer/pendingReviewsGrid");

    // List of Crucible Server instances
    var crucibleServerList = [];

    // User object
    var user;

    // List of reviewers
    var reviewerList = [];
  </script>

  <!-- App JS -->
  <script src="../src/js/renderer/ipc.js"></script>
  <script src="../src/js/renderer/app-renderer.js"></script>
  <script src="../src/js/renderer/common.js"></script>
  <script src="../src/js/renderer/review.js"></script>
  <script src="../src/js/renderer/serverModal.js"></script>
  <script src="../src/js/renderer/loginModal.js"></script>
  <script src="../src/js/renderer/settingsModal.js"></script>
  <script src="../src/js/renderer/infoModal.js"></script>
  <script src="../src/js/renderer/createReviewModal.js"></script>
  <script src="../src/js/renderer/searchReviewModal.js"></script>
</head>

<body>
  <!-- DIV for Particles JS -->
  <div id="particles-js"></div>
  
  <!-- App Wrapper (includes everything except the Modals -->
  <div id="appWrapper" class="app-wrapper blackout">
    <!-- App Side Nav Bar -->
    <nav id="sidebar">
      <div class="sidebar-header"></div>

      <!-- App Side Nav Bar Components -->
      <ul class="list-unstyled list-components">
        <li>
          <img class="profile-picture" id="profilePicture" src="" alt="userProfile" height="45px" width="45px">
        </li>
        <li>
          <label class="user-id-label" id="userIDLabel"></label>
        </li>
      </ul>

      <ul class="list-unstyled list-components side-nav-btn-list">
        <li>
          <button class="btn btn-dark nav-btn-sml navbar-btn" onclick="launchServerModal()" title="Server Instances">
            <i class="fas fa-server"></i>
          </button>
          <button class="btn btn-dark nav-btn-sml navbar-btn" onclick="launchSettingsModal()" title="Settings">
            <i class="fas fa-wrench"></i>
          </button>
          <button class="btn btn-dark nav-btn-sml navbar-btn" onclick="launchInfoModal()" title="Info">
            <i class="fas fa-info"></i>
          </button>
        </li>
        <li>
          <button class="btn btn-danger nav-btn" onclick="logout()">Logout</button>
        </li>
      </ul>
    </nav>

    <!-- App Top Nav Bar Header -->
    <header>
      <nav class="navbar navbar-expand-md fixed-top">
        <div id="sideNavContent" class="side-nav-content">
          <!-- App Side Nav Bar Toggle -->
          <button type="button" id="sidebarCollapse" class="navbar-btn">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
        <!-- Centered App Brand Label -->
        <ul class="nav navbar-nav mx-auto">
          <li class="nav-item">
            <img class="brand-header-logo" src="../resources/icons/app.png" height="20" width="20" id="brandHeaderNavImg">
          </li>
          <li class="nav-item">
            <span class="navbar-brand-label">Crucible Dashboard</span>
          </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li>
            <button type="button" class="pull-right btn btn-dark app-title-btn top-nav-content" onclick="minimizeApp()">&nbsp;&#8722;&nbsp;</button>
          </li>
          <li>
            <button type="button" class="pull-right btn btn-dark app-title-btn top-nav-content" onclick="maximizeApp()">&nbsp;&#2109;&nbsp;</button>
          </li>
          <li>
            <button type="button" class="pull-right btn btn-dark app-title-btn top-nav-content" onclick="closeApp()">&nbsp;X&nbsp;</button>
          </li>
        </ul>
      </nav>
    </header>

    
      <!-- Main Content -->
      <main role="main" class="container content">
        <!-- Main Button Container -->
        <div class="button-container" id="mainButtonContainer">
          <button id="createReviewButton" class="btn btn-primary btn-sm main-btn create-review-button" type="button" onclick="launchCreateReviewModal()">
            Create
          </button>
          <button id="searchReviewButton" class="btn btn-primary btn-sm main-btn search-review-button" type="button" onclick="launchSearchReviewModal()">
            Search&nbsp;
            <i class="fas fa-search"></i>
          </button>
          <button id="pendingReviewsToggle" class="btn btn-primary btn-sm main-btn pending-review-toggle disabled" type="button">
            Pending
            <span id="pendingBadge" class="badge badge-light">0</span>
          </button>
          <button id="refreshPendingButton" class="btn btn-success btn-sm refresh-pending-button" type="button" onclick="retrievePendingReviews()">
            <i id="refreshPendingIcon" class="fas fa-sync"></i>
          </button>
          <button id="openReviewsToggle" class="btn btn-primary btn-sm main-btn open-review-toggle disabled" type="button">
            Open
            <span id="openBadge" class="badge badge-light">0</span>
          </button>
          <button id="refreshOpenButton" class="btn btn-success btn-sm refresh-open-button disabled" type="button">
            <i class="fas fa-sync"></i>
          </button>
          <button id="reviewStatisticsToggle" class="btn btn-primary btn-sm main-btn review-statictics-toggle disabled" type="button">
            Statistics
          </button>
          <button id="refreshStaticticsButton" class="btn btn-success btn-sm refresh-statictics-button disabled" type="button">
            <i class="fas fa-sync"></i>
          </button>
        </div>

        <!-- Wrapper DIV for pending reviews  -->
        <div class="pending-reviews-container">
          <div id="pendingReviewsTable" class="pending-reviews-table-container"></div>
        </div>

        <!-- Wrapper DIV for open reviews  -->
        <div class="open-reviews-container" style="display: none">
          <div id="openReviewsTable" class="open-reviews-table-container" style="display: none"></div>
        </div>

        <!-- Wrapper DIV for statistics  -->
        <div class="review-statistics-container" style="display: none">
        </div>
      </main>
    <!-- </div> -->

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        node.js:
        <script>
          document.write(process.versions.node)
        </script> | Chromium:
        <script>
          document.write(process.versions.chrome)
        </script> | Electron:
        <script>
          document.write(process.versions.electron)
        </script> | Crucible Dashboard Â©
        <script type="text/javascript">
          document.write(new Date().getFullYear())
        </script>
        <a href="https://github.com/InViN/crucible-dashboard/blob/master/README.md#crucible-dashboard">
          <img class="github-footer-img" src="../resources/logo/github-logo.svg" height="18" width="18">
        </a>
      </div>
    </footer>

  </div>

  <!-- Server Instances Modal -->
  <div class="modal fade bd-example-modal-lg" id="serverModal" tabindex="-1" role="dialog" aria-labelledby="serverModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body modal-background">
          <p class="lead">Crucible server instance(s):
            <button type="button" class="btn btn-primary btn-sm btn-modal" onclick="addServerInstanceInput(null)">&nbsp;+&nbsp;</button>
            <div class="form-check form-check-inline">
              <label class="form-check-label">
                <input type="checkbox" class="form-check-input" value="" onchange="checkServerModalHTTPS(this);" id="httpsCheckBox">HTTPS
              </label>
            </div>
          </p>
          <div class="crucible-server-input" id="crucibleServerInputDiv">
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text server-modal-input-https-span" id="basic-addon3">http://</span>
              </div>
              <input type="text" class="form-control crucible-server" id="basic-url" aria-describedby="basic-addon3" autofocus>
            </div>
          </div>
          <div class="modal-footer modal-background">
            <button type="button" class="btn btn-primary" onclick="saveServerInput()">Save
              <i id="saveServerIcon" class="" aria-hidden="true"></i>
            </button>
            <button type="button" class="btn btn-danger" onclick="dismissServerModal()">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <div class="modal fade bd-example-modal-sm" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body modal-background">
          <div class="login-input login-modal" id="loginInputDiv">
            <div class="input-group mb-3">
              <input id="userID" class="form-control credential-input" type="text" autofocus="true" placeholder="User ID">
            </div>
            <div class="input-group mb-3">
              <input id="password" class="form-control credential-input" type="password" placeholder="Password">
            </div>
            <button type="button" class="btn btn-primary btn-login" onclick="login()">Login
              <i id="loginIcon" class="fa fa-sign-in" aria-hidden="true"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal fade bd-example-modal-lg" id="settingsModal" tabindex="-1" role="dialog" aria-labelledby="settingsModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body modal-background">
          To Do
          <div class="modal-footer modal-background">
            <button type="button" class="btn btn-primary" onclick="saveSettings()">Back</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Info Modal -->
  <div class="modal fade bd-example-modal-lg" id="infoModal" tabindex="-1" role="dialog" aria-labelledby="infoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body modal-background">
          <table class="table table-app-info borderless-table">
            <thead>
              <tr>
                <th class="borderless-table table-app-info-header" scope="col">Version Information</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="borderless-table" scope="row">App</th>
                <td class="borderless-table" id="appVersion"></td>
              </tr>
              <tr>
                <th class="borderless-table table-app-info-header" scope="col">Process Memory Information</th>
              </tr>
              <tr>
                <th class="borderless-table" scope="row">CPU Usage</th>
                <td class="borderless-table" id="cpuUsage"></td>
              </tr>
              <tr>
                <th class="borderless-table" scope="row">Working Set Size
                  <small id="totalMemoryHelpText" class="form-text text-muted">Amount of memory currently pinned to physical RAM</small>
                </th>
                <td class="borderless-table" id="workingSetSize"></td>
              </tr>
              <tr>
                <th class="borderless-table" scope="row">Peak Working Set Size
                  <small id="totalMemoryHelpText" class="form-text text-muted">Maximum amount of memory that has ever been pinned to actual physical RAM</small>
                </th>
                <td class="borderless-table" id="peakWorkingSetSize"></td>
              </tr>
              <tr>
                <th class="borderless-table" scope="row">Private Bytes
                  <small id="totalMemoryHelpText" class="form-text text-muted">Amount of memory in heap (JavaScript, HTML), not shared by other processes</small>
                </th>
                <td class="borderless-table" id="privateBytes"></td>
              </tr>
              <tr>
                <th class="borderless-table" scope="row">Shared Bytes
                  <small id="totalMemoryHelpText" class="form-text text-muted">Amount of memory shared between processes</small>
                </th>
                <td class="borderless-table" id="sharedBytes"></td>
              </tr>
              <tr>
                <th class="borderless-table table-app-info-header" scope="col">System Memory Information</th>
              </tr>
              <tr>
                <th class="borderless-table" scope="row">Total Memory
                  <small id="totalMemoryHelpText" class="form-text text-muted">Total amount of physical memory available to the system</small>
                </th>
                <td class="borderless-table" id="totalMemory"></td>
              </tr>
              <tr>
                <th class="borderless-table" scope="row">Free Memory
                  <small id="totalMemoryHelpText" class="form-text text-muted">Total amount of memory not being used by applications or disk cache</small>
                </th>
                <td class="borderless-table" id="freeMemory"></td>
              </tr>
            </tbody>
          </table>
          <div class="modal-footer modal-background">
            <button type="button" class="btn btn-primary" onclick="dismissInfoModal()">Back</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Create Review Modal -->
  <div class="modal fade bd-example-modal-lg" id="createReviewModal" tabindex="-1" role="dialog" aria-labelledby="createReviewModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body modal-background">
          <p class="lead">Crucible server instance(s):</p>
          <div class="crucible-server-radio" id="crucibleServerRadioDiv"></div>
          <div class="review-info-div" id="reviewInfoDiv">
            <div class="input-group mb-2">
              <input id="projectKey" class="form-control form-control-sm" type="text" placeholder="Project Key" style="width:500px;">
            </div>
            <div class="input-group mb-2">
              <input id="reviewName" class="form-control form-control-sm" type="text" placeholder="Review Name" style="width:500px;">
            </div>
            <div class="input-group mb-2">
              <input id="reviewDesc" class="form-control form-control-sm" type="text" placeholder="Review Description/Objectives" style="width:500px;">
            </div>
            <div class="input-group mb-2">
              <input id="jiraKey" class="form-control form-control-sm" type="text" placeholder="JIRA Key" style="width:500px;">
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="allowReviewerJoinCheck" checked>
              <label class="form-check-label" for="allowReviewerJoinCheck">Allow Reviewers To Join?</label>
            </div>
          </div>
          <p class="lead">Add Reviewer
            <button type="button" class="btn btn-primary btn-sm btn-modal" onclick="addReviewer(null)">
              &nbsp;+&nbsp;
            </button>
          </p>
          <div class="reviewer-list" id="reviewerListDiv"></div>
          <div class="modal-footer modal-background">
            <button type="button" class="btn btn-primary" onclick="createReview()">Create
              <i id="createReviewIcon" class="" aria-hidden="true"></i>
            </button>
            <button type="button" class="btn btn-danger" onclick="dismissCreateReviewModal()">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search Modal -->
  <div class="modal fade bd-example-modal-lg" id="searchReviewModal" tabindex="-1" role="dialog" aria-labelledby="searchReviewModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body modal-background">
          <p class="lead">Search for Reviews by JIRA</p>
          <div class="crucible-server-radio" id="searchCrucibleServerRadioDiv"></div>
          <div class="input-group mb-2 jira-search-key-input">
            <input id="jiraSearchKey" class="form-control form-control-sm" type="text" placeholder="JIRA Key" style="width:100px;">
            <button type="button" class="btn btn-primary btn-sm btn-modal" onclick="searchForReview()">
              <i id="searchForReviewIcon" class="fas fa-search"></i>
            </button>
          </div>
          <div id="searchResultsDiv"></div>
          <div class="modal-footer modal-background">
            <button type="button" class="btn btn-primary" onclick="dismissSearchReviewModal()">Back</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Self executing function for 'active' class toggle on Side Bar Collapse
    // jQuery:
    $(document).ready(function () {
      $('#sidebarCollapse').on('click', function () {
        $('#sidebar').toggleClass('active');
        $(this).toggleClass('active');
      });

      document.getElementById("refreshPendingButton").click();
    });
    // JavaScript:
    // (function() {
    //   document.getElementById("sidebarCollapse").addEventListener("click", function(event){
    //     document.querySelector('#sidebar').classList.toggle('active');
    //     event.target.classList.toggle('active');
    //   });
    // })();
  </script>
</body>

</html>